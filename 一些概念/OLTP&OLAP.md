### 1.概念解析

OLTP(Online transaction processing）:在线/联机事务处理。典型的OLTP类操作都比较简单，主要是对数据库中的数据进行增删改查，操作主体一般是产品的用户。

OLAP(Online analytical processing): 指联机分析处理。通过分析数据库中的数据来得出一些结论性的东西。比如给老总们看的报表，用于进行市场开拓的用户行为统计，不同维度的汇总分析结果等等。操作主体一般是运营、销售和市场等团队人员。

单次OLTP处理的数据量比较小，所涉及的表非常有限，一般仅一两张表。而OLAP是为了从大量的数据中找出某种规律性的东西，经常用到count()、sum()和avg()等聚合方法，用于了解现状并为将来的计划/决策提供数据支撑，所以对多张表的数据进行连接汇总非常普遍。

为了表示跟OLTP的数据库（database）在数据量和复杂度上的不同，一般称OLAP的操作对象为数据仓库（data warehouse），简称数仓。数据库仓库中的数据，往往来源于多个数据库，以及相应的业务日志。

### 2.区别和特点

|          | OLTP                                                   | OLAP                       |
| -------- | ------------------------------------------------------ | -------------------------- |
| 操作     | 结构化的和重复的，简短、原子、独立的事务               | 即时，复杂的查询           |
| 数据类型 | 详细，最新的数据                                       | 历史，聚合的数据           |
| 数据量   | 很少，往往数10条记录                                   | 很大，上百万条记录         |
| 数据存储 | 几百MB～GB级别的操作型数据库，对一致型和可恢复行要求高 | 几百GB~TB级别的数据仓库    |
| 性能指标 | 事务的吞吐量                                           | 单个查询的吞吐量和响应时间 |

|          | OLTP             | OLAP                 |
| -------- | ---------------- | -------------------- |
| 操作对象 | 数据库           | 数据仓库             |
| 数据量   | 数据量较小       | 数据量大             |
| 数据模型 | 实体-关系（ER）  | 星型或雪花型         |
| 数据时效 | 当前数据         | 当前及历史数据       |
| 数据操作 | 支持DML,DDL      | 一般不支持更新和删除 |
| 操作粒度 | 记录级           | 涉及多表             |
| 性能要求 | 高吞吐，低延时   | 性能要求相对较低     |
| 操作目的 | 查询或改变现状   | 分析规律，预测趋势   |
| 业务类型 | 账户查询，转账等 | 统计报告，多维度分析 |

### 3.OLAP的查询跟OLTP查询具体有那些不一样

OLTP查询一般仅涉及单表，点查为主，返回的是记录本身或该记录的多个列。即使是范围查询，基本上也会通过limit来限制返回的记录数。

而OLAP则不同，表中单条记录本身并不是查询所关心的，比较典型的特点包括有聚合类算子、涉及多表Join。这些操作都非常耗计算资源，而且数据仓库相比数据库在数据量上大很多，因此，OLAP类查询经常表现为cpu-bound而不是io-bound。

OLTP和OLAP发展到现在已经比较成熟，业界也有些公认的benchmark来进行性能评估。对于OLTP来说，有sysbench和tpcc测试套件，对于OLAP来说，有tpch和tpcds 2种。