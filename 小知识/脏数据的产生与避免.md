#### 脏数据的定义：

定义：脏数据（Dirty data），也叫坏数据（Bad data），通常是指跟期待的数据不一样、会影响系统正常行为的数据。

#### 生产环境缺陷的几种原因：

1. 代码错误
2. **脏数据**
3. 其他

#### 造成脏数据的原因：

1. 脏读：读取了事务处理中间状态的数据
2. 重复插入了相同的数据：多次点击同一个按钮没有控制唯一性、多个实例执行定时任务等
3. 不能为空的字段存为空：数据库字段没有验证、对于历史数据没有做好迁移处理等
4. 人工录入不合法的数据：比如电话号码存有特殊字符、人工改数据库数据
5. 运行sql脚本插入了不合法数据：不同的实体id搞混、sql脚本未区分环境等
6. 测试环境部署了一些半成品服务，产生了脏数据，没有及时清理，升版时直接升级演示环境
7. ...

#### 脏数据的危害：

根据不同的系统、不同的业务，脏数据带来的危害也会不一样。

1. 脏读产生的数据往往是错误的，导致数据不真实性，或者数据的不一致性
2. 重复和其他不合法数据则可能导致系统行为的不正常，有时候还可能导致非常严重的故障，甚至有些没有暴露的脏数据可能带来不可预知的致命错误，造成的危害无法估量

#### 如何预防脏数据的产生：

1. 业务需求分析设计阶段：在业务分析的时候，根据业务需求，明确业务相关数据的特定要求
   1. 不能为空的字段
   2. 不能重复的字段
   3. 日期时间等范围、分页范围等
   4. 特殊字符的限制
   5. Eamil,电话号码，身份证号等的校验，如正则等方式
   6. 功能升级的时候考虑已有数据的迁移
   7. 特定含义的业务需求
   8. ...
2. 数据库和代码实现阶段：明确了数据的需求，可以根据需求定义和业务常识、开发常识，在实现层面对数据进行严格的约束和校验
   1. 数据库表的主外键、字段类型、是否允许为空，事务处理隔离等。
   2. 前后端对数据进行严格的校验，防止各种手段存入不合法的数据，包括需求定义的数据和常识性的数据，比如身份证号码最多18位等
   3. 考虑多用户同时处理可能带来的并发问题
   4. 防止按钮或者链接被重复多次点击，可重复点击通常在网速较慢时可能存入重复数据，幂等性校验
   5. 程序读取数据的时候进行处理，比如去掉多余空格、去重、大小写不敏感数据的处理
   6. ...
3. 测试的进一步保障：有了需求定义和实现层面的校验，大部分的不合法数据被阻止了，但是还是会有漏网之鱼，在测试的时候继续采取相应的措施来进一步防御
   1. 业务需求规定的数据：常规测试
   2. 常识性的数据：根据测试人员的常识进行交叉测试
   3. 边界数据：边界测试，数据类型边界、信任域边界、特殊数据值、复活节彩蛋
   4. 尽量避免任何测试人员、开发人员、运维人员手工修改测试环境、灰度环境的数据，严令禁止修改生产环境数据
   5. Tips:复活节彩蛋是应用程序中内置的一些特殊功能 - 也许是有趣的东西，例如迷你游戏或带有团队名称的积分滚动。软件中的第一个复活节彩蛋出现在 Atari 2600 游戏冒险中。如果玩家捡到某个无形的物体，他们会进入一个密室并看到来自游戏创作者的消息。这个房间没有出现在任何文档或测试中，因为没有其他人知道它。复活节彩蛋很有趣，但它们可能会暴露漏洞，特别是如果没有经过彻底的测试。我见过的一个有缺陷的复活节彩蛋是一个特殊的标志，它在独特的日子里取代了我们在应用程序上的普通品牌。例如，在像独立日这样的假期，标志会改变颜色并带有烟花图案。这很有趣——除了那一次它不起作用并且用户看到了 404 错误。图形已损坏，我们没有在发布前测试该特定假期日期。
4. 线上用户培训
   1. 在界面上给出清晰的提示，告诉用户某些数据输入的要求
   2. 给用户培训或者提供用户手册，告诉用户该怎么正确使用系统

